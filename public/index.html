<!doctype html>
<html ng-app="app" >
<head>
	<title>Quick Links</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="stylesheets/model.css">
	<link rel="stylesheet" type="text/css" href="stylesheets/style.css">

	<!-- jQuery library -->
	<script src="vendor/jquery.js"></script>

	<!-- Latest compiled JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
	<script src="vendor/angular.js"></script>
	<script src="vendor/angular-route.js"></script>
	<script src="vendor/angular-resource.js"></script>
	<script src="vendor/angular-animate.js"></script>
	<script src="vendor/underscore.js"></script>
	<script src="vendor/bootbox.js"></script>
	<script src="vendor/pasteimage.js"></script>
	<script src="javascripts/app.js"></script>
	<script src="javascripts/modals.js"></script>
	<script src="javascripts/directives.js"></script>
	<script src="javascripts/filters.js"></script>
	<script src="javascripts/iterators.js"></script>
	<script src="javascripts/pager.js"></script>
	<script src="javascripts/tabitemscontext.js"></script>
	<script src="javascripts/milestones.js"></script>
	<script src="javascripts/resources.js"></script>
	<script src="javascripts/search.js"></script>
	<script src="javascripts/settings.js"></script>
	<script src="javascripts/settings-services.js"></script>
</head>

<body ng-controller="HomeCtrl" style="padding:10px">

<script>

	// See: https://github.com/vladmalik/pasteimage
	// 		https://groups.google.com/forum/#!msg/angular/kqFrwiysgpA/eB9mNbQzcHwJ
	function paste(imageData) {
		var targetID = 'imageHolderPasteTargetID';
		var e = document.getElementById(targetID);
		if (e !== null) {
			var scope = angular.element(e).scope();
			scope.$apply(function() {
				scope.pasteImageData(imageData);
			});
		} else {
			console.log("Paste target not found for: " + targetID);
		}
	};

	$(function() {
		$.pasteimage(paste);
	});

</script>



<div class="container-fluid"> <!-- container-fluid -->


	<!-- Need to show the application buttons when there are no sections yet! -->
	<div ng-if="refSectionsHorizontals.length === 0" class="row voffset1">
		<div class="col-lg-2 col-lg-offset-10" style="padding-right: 0">
				<div ng-include="'views-ng/appbuttons.html'"></div>
		</div>
	</div>

	<!-- refHorizontalRows -->

	<div class="row voffset1" ng-repeat="hrow in refHorizontalRows">
		<div ng-if="$index===0" class="col-lg-10">
			<section ng-repeat="section in hrow" sdata="section" edit="edit"></section>
		</div>
		<div ng-if="$index===0" class="col-lg-2" style="padding-right: 0">
			<div ng-include="'views-ng/appbuttons.html'"></div>
		</div>

		<div ng-if="$index!==0" class="col-lg-10">
			<section ng-repeat="section in hrow" sdata="section" edit="edit"></section>
		</div>

	</div>

	<br/>

	<div class="row voffset1" ng-repeat="vrow in vrows">
		<div ng-repeat="v in vrow" ng-class="bootstrapColumnStyle">
				<sectionv sdata="v" edit="edit"  fold="settings.mainScreenListFold"></sectionv>
		</div>
	</div>

<div twmodals ng-show="subview" class="tw-m-modals" ng-switch="subview">
	<div style="width:1100px; margin-left:-550px;" ng-switch-when="setup" ng-controller="SetupModalController" class="tw-modal container">
		<div class="col-md-12" style="overflow-y:auto; height:700px;">

			<div class="row">
				<div class="col-md-2 col-md-offset-5">
					<h4>Reference Edit <span ng-if="dirtyDataIndicator">(*)</span></h4>
				</div>
			</div>

			<div class="row" ng-show="serverError!==''">
				<div class="alert alert-danger col-md-8 col-md-offset-2"
					 role="alert">
					 <button type="button" ng-click="serverError=''" class="close">&times;</button>
					 <strong>ERROR: </strong>{{serverError}}
				</div>
			</div>

			<div class="row">
				<div class="col-md-10 col-md-offset-1" >
					<form class="row form-inline form-group-md">

						<div class="btn-group col-md-2">
							<button type="button" class="btn btn-primary">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{mode}}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</button>
							<button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown">
								<span class="caret"></span>
							</button>
							<ul class="dropdown-menu">
								<li><a href="#" ng-click="modeChanged('Add')" >Add</a></li>
								<li><a href="#" ng-click="modeChanged('Edit')" >Edit</a></li>
							</ul>
						</div>

						<div class="form-group col-md-4">
							<input ng-model="currentRefSection.title"
										 ng-disabled="!currentRefSection"
											type="text" class="form-control" id="refTitle" placeholder="Enter Title" style="width:100%"
									ng-change="titleChanged()">
						</div>

						<div class="form-group col-md-4">
							<label for="selectTitles">Select:</label>
							<select class="form-control" id="selectTitles" placeholder="Select Title" style="width:75%"
									ng-model="selectedRefSection"
									ng-options="rsec.title for rsec in refSections"
									ng-change="currentRefSectionChanged()"
									ng-disabled="mode !== 'Edit' || dirtyDataIndicator">
							</select>

						</div>

						<div class="form-group col-md-2">
							<label for="refKey">Key:</label>
							<input ng-model="currentRefSection.key"
							       ng-disabled="!currentRefSection"
										 type="text" class="form-control" id="refKey" style="width:69%">
						</div>

					</form>
				</div>
			</div>

			<div class="row voffset2">
				<div class="col-md-10 col-md-offset-1">
					<form class="row form-inline form-group-md">
						<div class="form-group col-md-6">
							<input  ng-model="currentRefSection.comment" ng-disabled="!currentRefSection"
									type="text" class="form-control" id="refComment" placeholder="Add comment" style="width:100%">
						</div>

						<div class="btn-group col-md-2">
							<button type="button" ng-model="currentRefSection.sectionType" ng-disabled="!currentRefSection"
										  class="btn btn-primary">{{currentRefSection.sectionType ? currentRefSection.sectionType : "Vert"}}</button>
							<button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown"
											ng-disabled="!currentRefSection">
											<span class="caret"></span>
							</button>
							<ul class="dropdown-menu">
								<li><a href="#" ng-click="sectionTypeChanged('Vert')" >Vert</a></li>
								<li><a href="#" ng-click="sectionTypeChanged('Horz')" >Horz</a></li>
							</ul>
						</div>

						<div class="form-group col-md-2">
							<label for="refSectionSize">Size:</label>
							<input ng-model="currentRefSection.sectionSize"
										 ng-disabled="!currentRefSection || currentRefSection.sectionType !== 'Horz'"
										 min="1"
										 max="12"
										 type="number"
										 class="form-control" id="refSectionSize"
										 style="width:55%" ng-change="sectionSizeChanged()">
						</div>

						<div class="form-group col-md-2">
							<label for="refSectionOrder">Ord:</label>
							<input ng-model="currentRefSection.sectionOrder"
										 ng-disabled="!currentRefSection"
										 min="1"
										 type="number"
										 class="form-control" id="refSectionOrder"
										 style="width:70%" ng-change="sectionOrderChanged()">
						</div>
					</form>
				</div>
			</div>

			<div class="row voffset1">
				<div class="col-md-10 col-md-offset-1">
					<ul class="nav nav-tabs" ng-disabled="!currentRefSection" >
						<li ng-class="{active:activeTab==='JUMP'}">  			<a data-toggle="tab" class="twtabnavigation" href="#jumpList">Jump List</a></li>
						<li ng-class="{active:activeTab==='LINK'}" > 			<a data-toggle="tab" class="twtabnavigation" href="#linkList">Links List</a></li>
						<li ng-class="{active:activeTab==='MILESTONE'}">  <a data-toggle="tab" class="twtabnavigation" href="#milestones">Milestones</a></li>
					</ul>

					<div class="tab-content well" style="padding-top:2px; padding-bottom: 2px; margin-bottom:2px">
						<div id="jumpList" class="tab-pane fade ng-class:{'in active':activeTab==='JUMP'}">
							<div class="row voffset2">
								<div class="form-group col-md-6">
									<input ng-model="tabJumpItemsCtx.selectedItem.title"
										   type="text" class="form-control"
										   placeholder="Enter title for item" style="width:100%">
								</div>

								<div class="form-group col-md-4">
									<input ng-model="tabJumpItemsCtx.selectedItem.link"
										   type="text" class="form-control" placeholder="Enter url" style="width:100%">
								</div>

								<div class="form-group col-md-2">
									<input ng-model="tabJumpItemsCtx.selectedItem.order"
										   type="number" min="1" class="form-control" style="width:100%">
								</div>

							</div>

							<div class="row">
								<div class="form-group col-md-12">
									<label for="comment">Note:</label>
									<textarea ng-model="tabJumpItemsCtx.selectedItem.note"
											  class="form-control" rows="2" id="comment"></textarea>
								</div>
							</div>

							<div class="row">
								<div class="col-md-3 col-md-offset-9">
									<button type="button" class="btn btn-warning btn-sm"
											ng-click="tabJumpItemsCtx.itemCancel()" >Clear</button>
									<button type="button" class="btn btn-danger btn-sm"
											ng-click="tabJumpItemsCtx.itemDelete(currentRefSection.jumpItems)">Delete</button>
									<button type="button" class="btn btn-primary btn-sm"
											ng-click="tabJumpItemsCtx.itemAddOrSave(currentRefSection.jumpItems)" >{{tabJumpItemsCtx.verb}}&nbsp;</button>
								</div>
							</div>

							<div class="row">
								<table class="table table-condensed table-hover voffset3" style="margin-bottom: 0;">
									<thead>
									<tr>
										<th class="col-md-3">Title</th>
										<th class="col-md-5">Note</th>
										<th class="col-md-2">Link</th>
										<th class="col-md-1">Ord</th>
										<th class="col-md-1">Select</th>
									</tr>
									</thead>
									<tbody>
									<tr class="info" ng-repeat="ii in currentRefSection.jumpItems | offset:pgJumpItems.offset() | limitTo:pgJumpItems.itemsPerPage">
										<td>{{ii.title | truncate:true:30:'...'}}</td>
										<td>{{ii.note | truncate:true:50:'...'}}</td>
										<td>{{ii.link | truncate:false:20:'...'}}</td>
										<td>{{ii.order}}</td>
										<td>
											<input type="checkbox"
												   ng-click="tabJumpItemsCtx.selectItem(($index + pgJumpItems.offset()), ii)"
												   ng-checked="(($index + pgJumpItems.offset()) === tabJumpItemsCtx.selectedRow)">
										</td>
									</tr>
									</tbody>
								</table>
								<div class="row">
									<div class="col-md-8 col-md-offset-2 text-center">
										<ul class="pagination" style="margin-top:6px; margin-bottom:6px">
											<li ng-class="pgJumpItems.prevPageDisabled()">
												<a href ng-click="pgJumpItems.prevPage()">«</a>
											</li>
											<li ng-repeat="n in pgJumpItems.range()"
												ng-class="{active: n == pgJumpItems.currentPage}" ng-click="pgJumpItems.setPage(n)">
												<a href="#">{{n+1}}</a>
											</li>
											<li ng-class="pgJumpItems.nextPageDisabled()">
												<a href ng-click="pgJumpItems.nextPage()">»</a>
											</li>
										</ul>
									</div>
								</div>
							</div>
						</div>  <!-- Closing jumpList Tab -->

						<div id="linkList" class="tab-pane fade ng-class:{'in active':activeTab==='LINK'}">
							<div class="row voffset2">
								<div class="form-group col-md-6">
									<input ng-model="tabLinkItemsCtx.selectedItem.title"
										   type="text" class="form-control"
										   placeholder="Enter title for item" style="width:100%">
								</div>

								<div class="form-group col-md-4">
									<input ng-model="tabLinkItemsCtx.selectedItem.link"
										   type="text" class="form-control" placeholder="Enter url" style="width:100%">
								</div>

								<div class="form-group col-md-2">
									<input ng-model="tabLinkItemsCtx.selectedItem.order"
										   type="number" min="1" class="form-control" style="width:100%">
								</div>

							</div>

							<div class="row">
								<div class="form-group col-md-12">
									  <ul class="nav nav-tabs">
									    <li class="active"> <a class="twtabnavigation" data-toggle="tab" href="#noteID">Note</a></li>
									    <li> <a class="twtabnavigation" data-toggle="tab" href="#imageUploadID">Images</a></li>
									  </ul>
									<div class="tab-content" style="padding-bottom: 1px;">
									  <div id="noteID" class="tab-pane fade in active">
									    <textarea ng-model="tabJumpItemsCtx.selectedItem.note"
									          class="form-control" rows="2" id="comment"></textarea>
									  </div>
									  <div id="imageUploadID"
												 class="tab-pane fade row" style="background-color:#1AB6D9; height:120px">
										  <imageholder> </imageholder>
										  <imageholder> </imageholder>
										  <imageholder> </imageholder>
										  <imageholder mode="'new'"
													   server-error="serverError"
													   item="tabJumpItemsCtx.selectedItem">
										  </imageholder>

									  </div>
									</div>


								</div>
							</div>

							<div class="row">
								<div class="col-md-3 col-md-offset-9">
									<button type="button" class="btn btn-warning btn-sm"
											ng-click="tabLinkItemsCtx.itemCancel()" >Clear</button>
									<button type="button" class="btn btn-danger btn-sm"
											ng-click="tabLinkItemsCtx.itemDelete()" >Delete</button>
									<button type="button" class="btn btn-primary btn-sm"
											ng-click="tabLinkItemsCtx.itemAddOrSave()" >{{tabLinkItemsCtx.verb}}&nbsp;</button>
								</div>
							</div>

							<div class="row">
								<table class="table table-condensed table-hover voffset3">
									<thead>
										<tr>
											<th class="col-md-3">Title</th>
											<th class="col-md-5">Note</th>
											<th class="col-md-2">Link</th>
											<th class="col-md-1">Ord</th>
											<th class="col-md-1">Select</th>
										</tr>
									</thead>
									<tbody>
										<tr class="info" ng-repeat="ii in currentRefSection.linkItems | offset:pgLinkItems.offset() | limitTo:pgLinkItems.itemsPerPage">
											<td>{{ii.title | truncate:true:30:'...'}}</td>
											<td>{{ii.note | truncate:true:50:'...'}}</td>
											<td>{{ii.link | truncate:false:20:'...'}}</td>
											<td>{{ii.order}}</td>
											<td>
												<input type="checkbox"
														 ng-click="tabLinkItemsCtx.selectItem($index + pgLinkItems.offset(), ii)"
													   ng-checked="(($index + pgLinkItems.offset()) === tabLinkItemsCtx.selectedRow)">
											</td>
										</tr>
									</tbody>
								</table>
								<div class="row">
									<div class="col-md-8 col-md-offset-2 text-center">
										<ul class="pagination" style="margin-top:6px; margin-bottom:6px">
											<li ng-class="pgLinkItems.prevPageDisabled()">
												<a href ng-click="pgLinkItems.prevPage()">«</a>
											</li>
											<li ng-repeat="n in pgLinkItems.range()"
												ng-class="{active: n == pgLinkItems.currentPage}" ng-click="pgLinkItems.setPage(n)">
												<a href="#">{{n+1}}</a>
											</li>
											<li ng-class="pgLinkItems.nextPageDisabled()">
												<a href ng-click="pgLinkItems.nextPage()">»</a>
											</li>
										</ul>
									</div>
								</div>
							</div>
						</div>  <!-- Closing linkList Tab -->
						<div id="milestones" class="tab-pane fade ng-class:{'in active':activeTab==='MILESTONE'}">
							<form>
								<div class="row">
									<div ng-repeat="t in msMgr.milestones" class="col-md-2"><strong>{{t.title}}</strong></div>
								</div>
								<div class="row voffset2">
									<div ng-repeat="d in msMgr.milestones" class="col-md-2"><input type="date" ng-model="d.date" style="width:100%"></div>
								</div>
								<div class="row voffset2">
									<div ng-repeat="e in msMgr.milestones" class="col-md-2" style="font-size:80%;">
											<label>
												<input type="radio" ng-model="e.status" value="reqd">
												Required
											</label><br/>
											<label>
												<input type="radio" ng-model="e.status" value="not-reqd">
												Not Required
											</label><br/>
											<label>
												<input type="radio" ng-model="e.status" value="done">
												Done
											</label><br/>
									</div>
								</div>
								<div class="row voffset4">
									<div class="col-md-3 col-md-offset-9">
										<button type="button" class="btn btn-warning btn-sm"
												ng-click="msMgr.clear()"
												ng-disabled="msMgr.milestones===undefined">Clear</button>
										<button type="button" class="btn btn-danger btn-sm"
												ng-click="msMgr.delete()"
												ng-disabled="msMgr.milestones===undefined">Delete</button>
										<button type="button" class="btn btn-primary btn-sm"
												ng-click="msMgr.save()"
												ng-disabled="msMgr.milestones===undefined">Save</button>
									</div>
								</div>

								<div class="row voffset2"></div>

							</form>
					    </div>  <!-- Closing milestones Tab -->
					</div>
					</div>
				</div>
			</div>

			<div class="row voffset1">
				<div class="col-md-4 col-md-offset-9">
					<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>

					<button type="button" class="btn btn-warning btn-sm" ng-click="cancel()" >Cancel</button>

					<button type="button" class="btn btn-danger btn-sm"
							ng-click="delete()"
							ng-disabled="currentRefSection._id === undefined">Delete</button>

					<button type="button" class="btn btn-primary btn-sm"
							ng-click="save()"
							ng-disabled="saveReady === false" >Save</button>
				</div>
			</div>
		</div>  <!-- Closing Setup -->


	<div style="width:1400px; margin-left:-700px;" ng-switch-when="noteDlg" ng-controller="NoteDialogModalController" class="tw-modal container">

		<div class="row voffset2">
			<div class="col-md-12">
					<div style="overflow-y:auto; height:400px;">
						<div dynamic="params.note"></div>
					</div>
			</div>
		</div>

		<div class="row">
			<div class="col-md-12 voffset2">
				<p class="pull-right">&nbsp &nbsp</p>
				<button ng-show="params.link" type="button" class="btn btn-primary btn-sm pull-right"
						ng-click="go()">{{title}}</button>
				<p class="pull-right">&nbsp</p>
				<button type="button" class="btn btn-warning btn-sm pull-right"
						ng-click="dismiss()">{{dismissText}}</button>
			</div>
		</div>
	</div> <!-- Closing noteDlg -->

	<div style="width:1100px; margin-left:-550px;" ng-switch-when="search" ng-controller="SearchModalController" class="tw-modal container">
		<div class="col-md-12">
			<div class="row">
				<div class="col-md-2 col-md-offset-5">
					<h4 class="text-center">Search </h4>
				</div>
			</div>
		</div>

		<div class="col-md-6 col-md-offset-3">

			<div class="pull-right">
				<label><small>Include URL Text?</small>
					<input type="checkbox" ng-model="searchUrlText" >
				</label>
			</div>

			<input ng-model="searchText"  placeholder="Enter search text and press enter key."
				   type="text" class="form-control" id="searchTextID" style="width:100%"
					 ng-keypress="search($event)" ng-change="searchTextChanged()">
		</div>

		<div class="col-md-12">
			<div class="row">
				<table class="table table-striped voffset3">
					<thead>
					<tr>
						<th class="col-md-2">Search results{{searchResultCount}}...</th>
					</tr>
					</thead>
					<tbody>
						<tr class="info" ng-repeat="ii in searchResults | offset:pgResultItems.offset() | limitTo:pgResultItems.itemsPerPage">
							<td>
									<a href="{{ii.link}}" target="_blank">{{ii.itemTitle}}</a>
									<span class="label label-primary">section:</span>
									<a ng-click="edit(ii.sectionKey)"> {{ii.sectionTitle}}</a>
									<span class="label label-primary">notes:</span>
									<cite>{{ii.text}}</cite> <small><strong>Rank:</strong></small>{{ii.rank}}
							</td>
						</tr>
					</tbody>
				</table>

				<div class="row">
					<div class="col-md-8 col-md-offset-2 text-center">
						<ul class="pagination" style="margin-top:6px; margin-bottom:6px">
							<li ng-class="pgResultItems.prevPageDisabled()">
								<a href ng-click="pgResultItems.prevPage()">«</a>
							</li>
							<li ng-repeat="n in pgResultItems.range()"
								ng-class="{active: n == pgResultItems.currentPage}" ng-click="pgResultItems.setPage(n)">
								<a href="#">{{n+1}}</a>
							</li>
							<li ng-class="pgResultItems.nextPageDisabled()">
								<a href ng-click="pgResultItems.nextPage()">»</a>
							</li>
						</ul>
					</div>
				</div>
			</div>
		</div>


		<div class="row">
			<div class="col-md-12">
				<button type="button" class="btn btn-primary btn-sm pull-right hroffset4"
						ng-click="close()">Close</button>
			</div>
		</div>

	</div> <!-- Closing search -->

	<div style="width:800px; margin-left:-400px;" ng-switch-when="settings" ng-controller="SettingsModalController" class="tw-modal container">
		<div class="col-md-12">
			<div class="row">
				<div class="col-md-2 col-md-offset-5">
					<h4 class="text-center">Settings</h4>
				</div>
			</div>
		</div>

		<div class="row">
			<div class="col-md-8 col-md-offset-2">
				<form class="form-horizontal">
				  <div class="form-group">
				    <label class="col-md-6 control-label">Main screen columns:</label>
				    <div class="col-md-6">
						<label class="radio-inline"><input ng-model="settingsEditBuffer.mainScreenColumns" value="1" type="radio" name="optradio">1</label>
						<label class="radio-inline"><input ng-model="settingsEditBuffer.mainScreenColumns" value="2" type="radio" name="optradio">2</label>
						<label class="radio-inline"><input ng-model="settingsEditBuffer.mainScreenColumns" value="3" type="radio" name="optradio">3</label>
						<label class="radio-inline"><input ng-model="settingsEditBuffer.mainScreenColumns" value="4" type="radio" name="optradio">4</label>
						<label class="radio-inline"><input ng-model="settingsEditBuffer.mainScreenColumns" value="6" type="radio" name="optradio">6</label>
				    </div>

				 </div>
				 <div class="form-group">
					 <label for="referenceListFoldID" class="col-md-6 control-label">Main screen reference list fold:</label>
					 <div class="col-md-6">
						 <input type="number" class="form-control" id="referenceListFoldID" placeholder="Enter positive number"
						 				ng-model="settingsEditBuffer.mainScreenListFold">
					 </div>
				</div>

				<div class="form-group">
				    <label for="searchResultRowsID" class="col-md-6 control-label">Search result page size:</label>
				    <div class="col-md-6">
				      <input type="number" class="form-control" id="searchResultRowsID" placeholder="Enter positive number"
										 ng-model="settingsEditBuffer.searchScreenResultNumberOfRows">
				    </div>
				</div>

			 </form>
			</div>
		</div>

		<div class="row">
			<div class="col-md-12">
				<button type="button" class="btn btn-primary btn-sm pull-right hroffset4"
						ng-click="save()">Save</button>
				<button type="button" class="btn btn-warning btn-sm pull-right hroffset4"
						ng-click="cancel()">Cancel</button>

				<small class="hloffset4 pull-left"><b>Version:</b> {{versionInfo.version}} <br/> <b>Date:</b> {{versionInfo.release}}</small>

			</div>
		</div>

	</div> <!-- Closing settings -->

</div>  <!-- Closing twmodal -->

</div> <!-- closing container -->

</body>

</html>
